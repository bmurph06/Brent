//VBScript which uses the pupil's DoB(Fields!DOB.Value) and Date Excluded(Fields!From.Value) to calculate the National Curriculum Year(NCY) that the pupil was in, when they were excluded. The script takes into account that the pupil could be in a lower/higher NCY due to special needs etc. by adding the offset value(Fields!NC_Year_Offset.Value). Additionally, if the returned value is "0" or "-1" the labels "Reception" and "Nursery" are attributed respectively. 





=Replace((System.Text.RegularExpressions.Regex.Replace((IIF(DateSerial(DatePart("yyyy",Today()), DatePart("m",Fields!DOB.Value), DatePart("d",Fields!DOB.Value)) <= DateSerial(DatePart("yyyy",Today()), 8, 31), (IIF(DateSerial(DatePart("yyyy",Today()), DatePart("m",Fields!From.Value), DatePart("d",Fields!From.Value)) <= DateSerial(DatePart("yyyy",Today()), 8, 31),((DatePart("yyyy",Today()) -(DatePart("yyyy",Fields!DOB.Value)+4))-(1+(DatePart("yyyy",Today())-DatePart("yyyy",Fields!From.Value)))+Fields!NC_Year_Offset.Value),((DatePart("yyyy",Today()) -(DatePart("yyyy",Fields!DOB.Value)+4))-(DatePart("yyyy",Today())-DatePart("yyyy",Fields!From.Value))+Fields!NC_Year_Offset.Value))   ), (IIF(DateSerial(DatePart("yyyy",Today()), DatePart("m",Fields!From.Value), DatePart("d",Fields!From.Value)) <= DateSerial(DatePart("yyyy",Today()), 8, 31),((DatePart("yyyy",Today()) -(DatePart("yyyy",Fields!DOB.Value)+5))-(1+(DatePart("yyyy",Today())-DatePart("yyyy",Fields!From.Value)))+Fields!NC_Year_Offset.Value),((DatePart("yyyy",Today()) -(DatePart("yyyy",Fields!DOB.Value)+5))-(DatePart("yyyy",Today())-DatePart("yyyy",Fields!From.Value))+Fields!NC_Year_Offset.Value))))), "\b0\b","Reception")), "-1","Nursery")
